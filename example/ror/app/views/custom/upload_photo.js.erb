<% if @photo.errors.any? %>
  result = {
    state: 'error',
    message: "<%= @photo.errors.full_messages.uniq.join(',') %>"
  };
<% else %>
  result = {
    state: 'ok',
    callback: function(){
      jQuery('div.photo.article').replaceWith("<%= escape_javascript(render(:partial => "single/photo", :locals => {:photo => @photo})) %>");
    }
  };
<% end %>

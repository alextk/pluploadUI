<% if @photo.errors.any? %>

(function(){
  return {
    error: true,
    message: "<%= @photo.errors.full_messages.uniq.join(',') %>"
  }
})();

<% else %>

  jQuery('div.photo.article').replaceWith("<%= escape_javascript(render(:partial => "single/photo", :locals => {:photo => @photo})) %>");
  jQuery("<%= escape_javascript(render(:partial => "queue/photo", :locals => {:photo => @photo})) %>").insertBefore(jQuery('div.photosList div.clear.end')).hide().fadeIn('slow');

<% end %>